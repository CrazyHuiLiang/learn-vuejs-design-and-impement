<!DOCTYPE html>
<html> 
    <head>
        <title>8-9. 更新子节点</title>
        <meta charset="utf-8">
        <style>
            #foo {
                color: red;
            }
            .bar {
                border-color: red;
            }
            .foo {
                border-style: dashed;
            }
        </style>
    </head>
    <body>
        <div id="app2"></div>
        <script type="module">
            import {effect, ref} from 'vue';
            import { renderer, normalizeClass } from './core.ts';


            // 渲染器除了要执行挂载之外，还需要执行更新动作
            // 通过将渲染器设计为可配置的通用渲染器，即可实现渲染到任意目标平台上
            (() => {
                
                const bol = ref(false);
                effect(() => {
                    const vnode = {
                        type: 'div',
                        props: {
                            id: 'foo',
                            class: normalizeClass([
                                'bar',
                                { foo: true },
                                { baz: false }
                            ]),
                            onClick: bol.value ? [
                                () => {
                                    console.log('div clicked');
                                },
                            ] : [],
                            onContextmenu: (e) => {
                                console.log('div right click');
                                e.preventDefault();
                            },
                        },
                        children: [
                            {
                                type: 'button',
                                children: 'disabled',
                                props: {
                                    disabled: false,
                                    onClick: () => {
                                        console.log('button clicked');
                                        bol.value = true;
                                    },
                                }
                            },
                        ],
                    };
                    renderer.render(vnode, document.getElementById('app2'));
                });
            })();
        </script>
    </body>
</html>